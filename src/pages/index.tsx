import Head from "next/head";
import type { InferGetStaticPropsType } from "next";
import NepaliDate from "nepali-date-converter";
import Image from "next/image";
import { HomePageResponse } from "~/types";
import Navbar from "@/components/Navbar";
import { ArrowRight, HistoryIcon, Menu, User, UserCircle } from "lucide-react";
import { formatDistanceToNow } from "date-fns";

import { Sheet, SheetContent, SheetTrigger } from "@/components/ui/sheet";

type PropType = InferGetStaticPropsType<typeof getStaticProps>;

export default function Home(props: PropType) {
  return (
    <>
      <Head>
        <title>Abiral Sanchar : Pathway To Enlightenment</title>
        <meta name="description" content="Generated by create-t3-app" />
        <link rel="icon" href="https://fav.farm/üì¢" />
      </Head>

      <div className="flex flex-row items-center  justify-between  p-4  ">
        <div className="hamburger block md:hidden">
          <UserCircle />
        </div>
        <div className="text-4xl ">
          <Image
            src="https://www.abiralsanchar.com/_next/static/media/abiralsancharlogo.aa7052d0.svg"
            alt="Abiral Sanchar Logo"
            width={200}
            height={200}
          />
          <div className="text-center  font-khand text-base ">
            {new NepaliDate(new Date()).toString()}
          </div>
        </div>
        <div className="hamburger block md:hidden">
          <Sheet>
            <SheetTrigger asChild>
              <Menu className="hover:cursor-pointer" />
            </SheetTrigger>
            <SheetContent className="w-3/6">
              <div className="flex flex-col text-center">
                <div className=" font-khand text-2xl font-bold">
                  Abiral<span className="text-primary">Sanchar</span>
                </div>
              </div>
            </SheetContent>
          </Sheet>
        </div>
      </div>

      <div className="hidden md:block">
        <Navbar />
      </div>
      <div className=" mx-10 flex flex-col  items-center   ">
        {props?.posts?.data[1]?.featured_articles?.map((news) => (
          <div
            key={news.id}
            className=" flex  w-full flex-col border-b py-2 text-center"
          >
            <div className="mt-2 font-khand text-2xl font-extrabold transition delay-150 duration-300 hover:cursor-pointer hover:text-primary md:text-3xl ">
              {news.title} 
            </div>
            <div className="mt-2 flex">
              <div className="mx-auto flex items-center">
                <HistoryIcon className="mr-2" />
                {formatDistanceToNow(news.created_at)} ago
              </div>
            </div>
          </div>
        ))}
      </div>


      {props.posts.data[4]?.articles_categorized?.category_article_data.map(category => (

        <div className="px-4 py-4">
          <div className="flex flex-row justify-between ">
            <div className="font-khand text-primary text-3xl">{category.category_title}</div>
            <ArrowRight className="text-primary" />
          </div>
          <div className="news-section">
            <div className="main-news flex flex-col items-center md:items-stretch md:flex-row  ">
              <Image
                alt="Hello"
                src={'https://www.onlinekhabar.com/wp-content/uploads/2024/01/Madhav-nepal-3-768x512.jpg'}
                width={500}
                height={500}
              />
              <div className="title-desc text-center pt-2  font-khand text-3xl w-[500px] bg-primary-foreground flex items-center justify-center">
                {category.articles[0]?.title}
              </div>
              <div className="remaining-news-hidden-sm  gap-3 hidden xl:flex  xl:flex-col ml-2 ">
                {category.articles.map(news => (
                  <div className="news flex items-start">
                    <img src="https://www.onlinekhabar.com/wp-content/uploads/2024/01/Madhav-nepal-3-768x512.jpg" className="w-30 h-24 rounded-sm" />
                    <span className="ml-2 hover: "> {news.title} </span>
                  </div>
                ))}
              </div>

              <div className="remaining-news-hidden-md md:hidden flex gap-3 flex-col mt-2 ml-2 ">
                {category.articles.map(news => (
                  <div className="news flex items-center">
                    <img src="https://www.onlinekhabar.com/wp-content/uploads/2024/01/Madhav-nepal-3-768x512.jpg" className="w-30 h-24 rounded-sm" />
                    <span className="ml-2 hover:text-primary"> {news.title}</span>
                  </div>
                ))}
              </div>
            </div>
          </div>
        </div>
      ))}

      {/* <div className="px-4 py-4">
        <div className="flex flex-row justify-between ">
          <div className="font-khand text-primary text-3xl">‡§∏‡§Æ‡§æ‡§ö‡§æ‡§∞</div>
          <ArrowRight className="text-primary" />
        </div>
        <div className="news-section">
          <div className="main-news flex flex-col items-center md:items-stretch md:flex-row  ">
            <Image
              alt="Hello"
              src={'https://www.onlinekhabar.com/wp-content/uploads/2024/01/Madhav-nepal-3-768x512.jpg'}
              width={500}
              height={500}
            />
            <div className="title-desc text-center pt-2  font-khand text-3xl w-[500px] bg-primary-foreground flex items-center justify-center">
              ‚Äò‡§ï‡§π‡§ø‡§≤‡•á ‡§™‡•ç‡§∞‡§ß‡§æ‡§®‡§Æ‡§®‡•ç‡§§‡•ç‡§∞‡•Ä ‡§¨‡§®‡•ç‡§®‡•á ‡§™‡§æ‡§≤‡•ã ‡§Ü‡§â‡§Å‡§õ ‡§≠‡§®‡•ç‡§®‡•á‡§Æ‡§æ ‡§Æ‡•á‡§∞‡•ã ‡§ß‡•ç‡§Ø‡§æ‡§® ‡§õ‡•à‡§®‚Äô
            </div>

            <div className="remaining-news-hidden-sm hidden xl:flex  xl:flex-col ml-2 ">
              <div className="news flex items-start">
                <img src="https://www.onlinekhabar.com/wp-content/uploads/2024/01/Madhav-nepal-3-768x512.jpg" className="w-30 h-24 rounded-sm" />
                <span className="ml-2 hover: "> ‡§ú‡§®‡§ï‡§™‡•Å‡§∞‡§Æ‡§æ ‡§Ö‡§ñ‡•ç‡§§‡§ø‡§Ø‡§æ‡§∞ ‡§™‡•ç‡§∞‡§Æ‡•Å‡§ñ‡§≤‡§æ‡§à ‡§™‡•ç‡§∞‡§∂‡•ç‡§® : ‡§ó‡•ã‡§¶‡§æ‡§Æ‡§Æ‡§æ ‡§•‡§®‡•ç‡§ï‡§ø‡§è‡§ï‡•ã ‡•´ ‡§π‡§ú‡§æ‡§∞ ‡§∏‡§æ‡§á‡§ï‡§≤ ‡§ï‡•á ‡§ó‡§∞‡•ç‡§®‡•á ?</span>
              </div>
            </div>

            <div className="remaining-news-hidden-md md:hidden flex  flex-col mt-2 ml-2 ">
              <div className="news flex items-center">
                <img src="https://www.onlinekhabar.com/wp-content/uploads/2024/01/Madhav-nepal-3-768x512.jpg" className="w-30 h-24 rounded-sm" />
                <span className="ml-2 hover:text-primary"> ‡§∞‡§Æ‡§æ ‡§Ö‡§ñ‡•ç‡§§‡§ø‡§Ø‡§æ‡§∞ ‡§™‡•ç‡§∞‡§Æ‡•Å‡§ñ‡§≤‡§æ‡§à ‡§™‡•ç‡§∞‡§∂‡•ç‡§® : ‡§ó‡•ã‡§¶‡§æ‡§Æ‡§Æ‡§æ ‡§•‡§®‡•ç‡§ï‡§ø‡§è‡§ï‡•ã ‡•´ ‡§π‡§ú‡§æ‡§∞ ‡§∏‡§æ‡§á‡§ï‡§≤ ‡§ï‡•á ‡§ó‡§∞‡•ç‡§®‡•á ?</span>
              </div>
            </div>
          </div>
        </div>
      </div> */}


    </>
  );
}

export async function getStaticProps() {
  const posts = (await (
    await fetch("https://jsugauta1.pythonanywhere.com/api/v1/news/homepage/", {
      method: "GET",
    })
  ).json()) as HomePageResponse;

  console.log(posts.data[1]?.featured_articles)
  return {
    props: {
      posts,
    },

    revalidate: 10,
  };
}
